<% result_qty = @profiles.count %>

<body>

  <%= render "app_components/header", classes: "bg-primary text-light flat", left_button: :back, right_buttons: [:options], back_link: "#{catalogo_path}?tab=bairros&list=#{@bairro.regiao}" %>

  <!-- App Capsule -->
  <div id="appCapsule" class="mt-3 mb-5">

    <!-- Search Results -->
    <% if result_qty > 0 %>

    <div class="header-large-title">
      <h1 class="title">
        <%= @bairro.name %>
        <!-- Filter -->
        <% if params[:categoria].present? %>
        <a href="<%= catalogo_bairro_path %>" class="btn btn-sm btn-outline pr-0 float-right text-primary">
          ver tudo
        </a>
        <% else %>
          <div class="dropdown float-right">
            <button class="btn btn-sm btn-outline dropdown-toggle text-primary pr-0" type="button" data-toggle="dropdown">
              filtrar
            </button>
            <div class="dropdown-menu dropdown-menu-right">
              <% @filtros.each do |filtro| %>
              <a href="<%= catalogo_bairro_path categoria: filtro[1] %>" class="dropdown-item">
                <%= filtro[0] %>
              </a>
              <% end %>
            </div>
          </div>
        <% end %>
        <!-- * Filter -->
      </h1>
      <h4 class="subtitle">
        <%= params[:categoria].present? ? "#{result_qty} #{@profiles.first.sub_categ.name.downcase}" : pluralize(result_qty, "negócio cadastrado", "negócios cadastrados") %>
      </h4>
    </div>

    <ul class="listview image-listview media search-result mt-2 mb-2">
      <% @profiles.each do |profile| %>
        <%= render 'catalogo/search_result', profile: profile %>
      <% end %>
    </ul>
    <%= will_paginate @profiles, renderer: WillPaginateInfinite::InfinitePagination %>

    <% end %>

  </div>
  <!-- * App Capsule -->

</body>

<script type="text/javascript">
$(document).ready(function () {
  mp_track("<%= MixPanel::CATALOGO_BAIRRO_VIEW %>", {
    "param_bairro": "<%= @bairro.name %>"
  });
});
</script>